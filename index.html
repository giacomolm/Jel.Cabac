<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Jel</title>

<link rel="stylesheet" href="css/codemirror.css" type="text/css" media="screen">
<link rel="stylesheet" href="css/bootstrap.css" type="text/css" media="screen">
<link rel="stylesheet" href="css/jstree/jstree.min.css" type="text/css" media="screen">
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen">
<link rel="stylesheet" href="css/scrollbar.css" type="text/css" media="screen">
<link rel="stylesheet" href="css/raphael.pan-zoom.css" type="text/css" media="screen">

<script type="text/javascript" src="lib/jel/jel.js"></script>
<script data-main="js/main" src="lib/require/require.js"></script>

<script>

	Jel.fn.init = function(){

		//Setting the xsd file in order to do validation
		try{
		  Jel.attachXSD('schema/cabac.xsd');
		  Jel.setBaseFile('xml/terms.xml');
		  Jel.setNamespace('http://www.w3.org/2001/XMLSchema-instance');
		  Jel.setBaseElement('terms');
		}
		catch(err){
		  console.log("Problems with http xml request");
		}

		var noop = new Jel.Shape();
		noop.setImage("img/noop.gif");
		noop.setName("Noop");
		noop.setDimension(84,55);
		noop.setMetaelement("noop", "term");	
		Jel.paletteShapes.addShape(noop);	

		var prod = new Jel.Shape();
		prod.setImage("img/prod.gif");
		prod.setName("Prod");
		prod.setDimension(102,54);
		prod.setMetaelement("prod", "term");
		var output_prod = prod.addElement("output", "label","img/arrow_up.png", 11, 27,46,-10);
		output_prod.setBehaviour('click', function(ev){document.getElementById(ev.target.id+",label").focus()});
		Jel.paletteShapes.addShape(prod);

		var cons = new Jel.Shape();
		cons.setImage("img/cons.gif");
		cons.setName("Cons");
		cons.setDimension(102,54);	
		cons.setMetaelement("cons", "term");
		cons.addElement("input", "label","img/arrow_down.png", 11, 27,46,-10);
		Jel.paletteShapes.addShape(cons);

		var trans = new Jel.Shape();
		trans.setImage("img/trans.gif");
		trans.setName("Trans");
		trans.setDimension(161,55);
		trans.setMetaelement("trans", "term");
		trans.addElement("input", "label","img/arrow_down.png", 11, 27,55,-10);	
		trans.addElement("output", "label","img/arrow_up.png", 11, 27,70,-10);
		Jel.paletteShapes.addShape(trans);

		var split = new Jel.Shape();
		split.setImage("img/split.gif");
		split.setName("Split");
		split.setDimension(233,54);
		split.setMetaelement("split", "term");
		split.addElement("input", "label","img/arrow_down.png", 11, 27,80,-10);	
		split.addElement("output", "label","img/arrow_up.png", 11, 27,110,-10);
		Jel.paletteShapes.addShape(split);		

		var merge = new Jel.Shape();
		merge.setImage("img/merge.gif");
		merge.setName("Merge");
		merge.setDimension(233,54);
		merge.setMetaelement("merge", "term");
		var merge_input = merge.addElement("input", "label","img/arrow_down.png", 11, 27,80,-10);	
		merge_input.setBehaviour('click', function(ev){document.getElementById(ev.target.id+",label").focus()});
		var merge_output = merge.addElement("output", "label","img/arrow_up.png", 11, 27,110,-10);
		merge_output.setBehaviour('click', function(ev){document.getElementById(ev.target.id+",label").focus()});
		Jel.paletteShapes.addShape(merge);	

		var order = new Jel.Shape();
		order.setImage("img/order.gif");
		order.setName("Order");
		order.setDimension(345,54);
		order.setMetaelement("order", "term");
		order.addElement("input", "label","img/arrow_down.png", 11, 27,80,-10);	
		order.addElement("output", "label","img/arrow_up.png", 11, 27,110,-10);		
		Jel.paletteShapes.addShape(order);		

		//Adding composed algebra terms to palette
		var plug = new Jel.Shape();
		plug.setImage("img/plug.gif");
		plug.setName("Plug");
		plug.setDimension(84,54);	
		plug.setAsComposed();
		plug.setMetaelement("plug", "term");
		Jel.paletteShapes.addShape(plug);	

		var altern = new Jel.Shape();
		altern.setImage("img/altern.gif");
		altern.setName("Altern");
		altern.setDimension(84,55);	
		altern.setAsComposed();
		altern.setMetaelement("altern", "term");
		Jel.paletteShapes.addShape(altern);	

		var conj = new Jel.Shape();
		conj.setImage("img/conj.gif");
		conj.setName("Conj");
		conj.setDimension(84,55);	
		conj.setAsComposed();
		conj.setMetaelement("conj", "term");	
		Jel.paletteShapes.addShape(conj);	

		var quot = new Jel.Shape();
		quot.setImage("img/quot.gif");
		quot.setName("Quot");
		quot.setDimension(84,55);	
		quot.setAsComposed();
		quot.setMetaelement("quot", "term");	
		Jel.paletteShapes.addShape(quot);

		var invert = new Jel.Shape();
		invert.setImage("img/inv.gif");
		invert.setName("Invert");
		invert.setDimension(84,55);	
		invert.setAsComposed();		
		invert.setMetaelement("invert", "term");
		Jel.paletteShapes.addShape(invert);

		//overriding the import function (in reality is a recall, with a new parameter)
		Jel.xmlImport = function(){Jel.fn.xmlImport("terms", "term")};
	}

</script>

</head>

<body>
	<div id="menu"></div>
	<div id="dialog"></div>
	<div id="notification"></div>
	<div id="middle">
		<div id="palette"><div id="paletteheader"><h5>Palette</h5></div></div>
		<div id="tab"></div>
		<div id="container">
			<div id="main" ondragover="event.preventDefault()"></div>
			<div id="dsl"></div>
		</div>
		<div id="rightMenu">
			<div id="treeheader"><h5>Tree</h5></div>
			<div id="tree" class="jstree jstree-1 jstree-default jstree-default-responsive" style="position: relative; overflow:hidden"></div>
			<div class="properties"><h5>Properties</h5><div id="properties_ul" style="position:relative"><ul id="properties"></ul></div></div>
			<div id="anteprimaheader"><h5>Anteprima</h5></div>
			<div id="anteprima"></div>
		</div>
	</div>
	
</body>
</html>
